{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { Command } from \"commander\";\nimport pc from \"picocolors\";\nimport { cpSync, existsSync, readFileSync, renameSync, writeFileSync } from \"node:fs\";\nimport { resolve, dirname, join } from \"node:path\";\nimport { fileURLToPath } from \"node:url\";\n\nconst __dirname = dirname(fileURLToPath(import.meta.url));\nconst templateDir = resolve(__dirname, \"..\", \"template\");\n\nconst program = new Command();\n\nprogram\n  .name(\"create-strayl-app\")\n  .description(\"Scaffold a new Strayl web application\")\n  .requiredOption(\"--name <name>\", \"Name of the new project\")\n  .action((opts: { name: string }) => {\n    const name = opts.name.trim();\n\n    if (!name) {\n      console.error(pc.red(\"Error: --name must not be empty.\"));\n      process.exit(1);\n    }\n\n    if (!/^[a-zA-Z0-9_@\\/-][a-zA-Z0-9_.\\-@\\/]*$/.test(name)) {\n      console.error(\n        pc.red(\n          \"Error: Invalid project name. Use only alphanumeric characters, hyphens, underscores, dots, and slashes.\"\n        )\n      );\n      process.exit(1);\n    }\n\n    const targetDir = resolve(process.cwd(), name);\n\n    if (existsSync(targetDir)) {\n      console.error(\n        pc.red(`Error: Directory \"${name}\" already exists.`)\n      );\n      process.exit(1);\n    }\n\n    if (!existsSync(templateDir)) {\n      console.error(\n        pc.red(\"Error: Template directory not found. The package may be corrupted.\")\n      );\n      process.exit(1);\n    }\n\n    console.log(pc.cyan(`Creating project \"${name}\"...`));\n\n    cpSync(templateDir, targetDir, { recursive: true });\n\n    // npm publish strips .gitignore, so we ship it as \"gitignore\" and rename here\n    const gitignorePath = join(targetDir, \"gitignore\");\n    if (existsSync(gitignorePath)) {\n      renameSync(gitignorePath, join(targetDir, \".gitignore\"));\n    }\n\n    const pkgJsonPath = join(targetDir, \"package.json\");\n    if (existsSync(pkgJsonPath)) {\n      const pkgJson = JSON.parse(readFileSync(pkgJsonPath, \"utf-8\"));\n      pkgJson.name = name;\n      writeFileSync(pkgJsonPath, JSON.stringify(pkgJson, null, 2) + \"\\n\");\n    }\n\n    console.log(pc.green(`\\nProject \"${name}\" created successfully!\\n`));\n    console.log(\"Next steps:\");\n    console.log(pc.cyan(`  cd ${name}`));\n    console.log(pc.cyan(\"  npm install\"));\n    console.log(pc.cyan(\"  npm run dev\"));\n    console.log();\n  });\n\nprogram.parse();\n"],"mappings":";;;;AAAA,SAAS,eAAe;AACxB,OAAO,QAAQ;AACf,SAAS,QAAQ,YAAY,cAAc,YAAY,qBAAqB;AAC5E,SAAS,SAAS,SAAS,YAAY;AACvC,SAAS,qBAAqB;AAE9B,IAAM,YAAY,QAAQ,cAAc,YAAY,GAAG,CAAC;AACxD,IAAM,cAAc,QAAQ,WAAW,MAAM,UAAU;AAEvD,IAAM,UAAU,IAAI,QAAQ;AAE5B,QACG,KAAK,mBAAmB,EACxB,YAAY,uCAAuC,EACnD,eAAe,iBAAiB,yBAAyB,EACzD,OAAO,CAAC,SAA2B;AAClC,QAAM,OAAO,KAAK,KAAK,KAAK;AAE5B,MAAI,CAAC,MAAM;AACT,YAAQ,MAAM,GAAG,IAAI,kCAAkC,CAAC;AACxD,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,MAAI,CAAC,wCAAwC,KAAK,IAAI,GAAG;AACvD,YAAQ;AAAA,MACN,GAAG;AAAA,QACD;AAAA,MACF;AAAA,IACF;AACA,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,QAAM,YAAY,QAAQ,QAAQ,IAAI,GAAG,IAAI;AAE7C,MAAI,WAAW,SAAS,GAAG;AACzB,YAAQ;AAAA,MACN,GAAG,IAAI,qBAAqB,IAAI,mBAAmB;AAAA,IACrD;AACA,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,MAAI,CAAC,WAAW,WAAW,GAAG;AAC5B,YAAQ;AAAA,MACN,GAAG,IAAI,oEAAoE;AAAA,IAC7E;AACA,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,UAAQ,IAAI,GAAG,KAAK,qBAAqB,IAAI,MAAM,CAAC;AAEpD,SAAO,aAAa,WAAW,EAAE,WAAW,KAAK,CAAC;AAGlD,QAAM,gBAAgB,KAAK,WAAW,WAAW;AACjD,MAAI,WAAW,aAAa,GAAG;AAC7B,eAAW,eAAe,KAAK,WAAW,YAAY,CAAC;AAAA,EACzD;AAEA,QAAM,cAAc,KAAK,WAAW,cAAc;AAClD,MAAI,WAAW,WAAW,GAAG;AAC3B,UAAM,UAAU,KAAK,MAAM,aAAa,aAAa,OAAO,CAAC;AAC7D,YAAQ,OAAO;AACf,kBAAc,aAAa,KAAK,UAAU,SAAS,MAAM,CAAC,IAAI,IAAI;AAAA,EACpE;AAEA,UAAQ,IAAI,GAAG,MAAM;AAAA,WAAc,IAAI;AAAA,CAA2B,CAAC;AACnE,UAAQ,IAAI,aAAa;AACzB,UAAQ,IAAI,GAAG,KAAK,QAAQ,IAAI,EAAE,CAAC;AACnC,UAAQ,IAAI,GAAG,KAAK,eAAe,CAAC;AACpC,UAAQ,IAAI,GAAG,KAAK,eAAe,CAAC;AACpC,UAAQ,IAAI;AACd,CAAC;AAEH,QAAQ,MAAM;","names":[]}