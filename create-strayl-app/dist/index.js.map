{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { Command } from \"commander\";\r\nimport pc from \"picocolors\";\r\nimport { cpSync, existsSync, readFileSync, renameSync, writeFileSync } from \"node:fs\";\r\nimport { resolve, dirname, join } from \"node:path\";\r\nimport { fileURLToPath } from \"node:url\";\r\n\r\nconst __dirname = dirname(fileURLToPath(import.meta.url));\r\nconst templateDir = resolve(__dirname, \"..\", \"template\");\r\n\r\nconst program = new Command();\r\n\r\nprogram\r\n  .name(\"create-strayl-app\")\r\n  .description(\"Scaffold a new Strayl web application\")\r\n  .requiredOption(\"--name <name>\", \"Name of the new project\")\r\n  .action((opts: { name: string }) => {\r\n    const name = opts.name.trim();\r\n\r\n    if (!name) {\r\n      console.error(pc.red(\"Error: --name must not be empty.\"));\r\n      process.exit(1);\r\n    }\r\n\r\n    if (!/^[a-zA-Z0-9_@\\/-][a-zA-Z0-9_.\\-@\\/]*$/.test(name)) {\r\n      console.error(\r\n        pc.red(\r\n          \"Error: Invalid project name. Use only alphanumeric characters, hyphens, underscores, dots, and slashes.\"\r\n        )\r\n      );\r\n      process.exit(1);\r\n    }\r\n\r\n    const targetDir = resolve(process.cwd(), name);\r\n\r\n    if (existsSync(targetDir)) {\r\n      console.error(\r\n        pc.red(`Error: Directory \"${name}\" already exists.`)\r\n      );\r\n      process.exit(1);\r\n    }\r\n\r\n    if (!existsSync(templateDir)) {\r\n      console.error(\r\n        pc.red(\"Error: Template directory not found. The package may be corrupted.\")\r\n      );\r\n      process.exit(1);\r\n    }\r\n\r\n    console.log(pc.cyan(`Creating project \"${name}\"...`));\r\n\r\n    cpSync(templateDir, targetDir, { recursive: true });\r\n\r\n    // npm publish strips .gitignore, so we ship it as \"gitignore\" and rename here\r\n    const gitignorePath = join(targetDir, \"gitignore\");\r\n    if (existsSync(gitignorePath)) {\r\n      renameSync(gitignorePath, join(targetDir, \".gitignore\"));\r\n    }\r\n\r\n    const pkgJsonPath = join(targetDir, \"package.json\");\r\n    if (existsSync(pkgJsonPath)) {\r\n      const pkgJson = JSON.parse(readFileSync(pkgJsonPath, \"utf-8\"));\r\n      pkgJson.name = name;\r\n      writeFileSync(pkgJsonPath, JSON.stringify(pkgJson, null, 2) + \"\\n\");\r\n    }\r\n\r\n    console.log(pc.green(`\\nProject \"${name}\" created successfully!\\n`));\r\n    console.log(\"Next steps:\");\r\n    console.log(pc.cyan(`  cd ${name}`));\r\n    console.log(pc.cyan(\"  npm install\"));\r\n    console.log(pc.cyan(\"  npm run dev\"));\r\n    console.log();\r\n  });\r\n\r\nprogram.parse();\r\n"],"mappings":";;;;AAAA,SAAS,eAAe;AACxB,OAAO,QAAQ;AACf,SAAS,QAAQ,YAAY,cAAc,YAAY,qBAAqB;AAC5E,SAAS,SAAS,SAAS,YAAY;AACvC,SAAS,qBAAqB;AAE9B,IAAM,YAAY,QAAQ,cAAc,YAAY,GAAG,CAAC;AACxD,IAAM,cAAc,QAAQ,WAAW,MAAM,UAAU;AAEvD,IAAM,UAAU,IAAI,QAAQ;AAE5B,QACG,KAAK,mBAAmB,EACxB,YAAY,uCAAuC,EACnD,eAAe,iBAAiB,yBAAyB,EACzD,OAAO,CAAC,SAA2B;AAClC,QAAM,OAAO,KAAK,KAAK,KAAK;AAE5B,MAAI,CAAC,MAAM;AACT,YAAQ,MAAM,GAAG,IAAI,kCAAkC,CAAC;AACxD,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,MAAI,CAAC,wCAAwC,KAAK,IAAI,GAAG;AACvD,YAAQ;AAAA,MACN,GAAG;AAAA,QACD;AAAA,MACF;AAAA,IACF;AACA,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,QAAM,YAAY,QAAQ,QAAQ,IAAI,GAAG,IAAI;AAE7C,MAAI,WAAW,SAAS,GAAG;AACzB,YAAQ;AAAA,MACN,GAAG,IAAI,qBAAqB,IAAI,mBAAmB;AAAA,IACrD;AACA,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,MAAI,CAAC,WAAW,WAAW,GAAG;AAC5B,YAAQ;AAAA,MACN,GAAG,IAAI,oEAAoE;AAAA,IAC7E;AACA,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,UAAQ,IAAI,GAAG,KAAK,qBAAqB,IAAI,MAAM,CAAC;AAEpD,SAAO,aAAa,WAAW,EAAE,WAAW,KAAK,CAAC;AAGlD,QAAM,gBAAgB,KAAK,WAAW,WAAW;AACjD,MAAI,WAAW,aAAa,GAAG;AAC7B,eAAW,eAAe,KAAK,WAAW,YAAY,CAAC;AAAA,EACzD;AAEA,QAAM,cAAc,KAAK,WAAW,cAAc;AAClD,MAAI,WAAW,WAAW,GAAG;AAC3B,UAAM,UAAU,KAAK,MAAM,aAAa,aAAa,OAAO,CAAC;AAC7D,YAAQ,OAAO;AACf,kBAAc,aAAa,KAAK,UAAU,SAAS,MAAM,CAAC,IAAI,IAAI;AAAA,EACpE;AAEA,UAAQ,IAAI,GAAG,MAAM;AAAA,WAAc,IAAI;AAAA,CAA2B,CAAC;AACnE,UAAQ,IAAI,aAAa;AACzB,UAAQ,IAAI,GAAG,KAAK,QAAQ,IAAI,EAAE,CAAC;AACnC,UAAQ,IAAI,GAAG,KAAK,eAAe,CAAC;AACpC,UAAQ,IAAI,GAAG,KAAK,eAAe,CAAC;AACpC,UAAQ,IAAI;AACd,CAAC;AAEH,QAAQ,MAAM;","names":[]}